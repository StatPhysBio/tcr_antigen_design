
'''

The following are adapted from AAindex: http://www.genome.jp/aaindex/

'''

import numpy as np

NEG_ABS_DIFF_VDW_RADIUS = {'G': {'G': -0.0, 'A': -1.0, 'C': -2.43, 'S': -1.6, 'P': -2.72, 'T': -2.6, 'V': -3.0, 'D': -2.78, 'I': -4.0, 'L': -4.0, 'N': -2.95, 'M': -4.43, 'Q': -3.95, 'K': -4.77, 'E': -3.78, 'H': -4.66, 'F': -5.89, 'R': -6.13, 'Y': -6.47, 'W': -8.08}, 'A': {'G': -1.0, 'A': -0.0, 'C': -1.4300000000000002, 'S': -0.6000000000000001, 'P': -1.7200000000000002, 'T': -1.6, 'V': -2.0, 'D': -1.7799999999999998, 'I': -3.0, 'L': -3.0, 'N': -1.9500000000000002, 'M': -3.4299999999999997, 'Q': -2.95, 'K': -3.7699999999999996, 'E': -2.78, 'H': -3.66, 'F': -4.89, 'R': -5.13, 'Y': -5.47, 'W': -7.08}, 'C': {'G': -2.43, 'A': -1.4300000000000002, 'C': -0.0, 'S': -0.8300000000000001, 'P': -0.29000000000000004, 'T': -0.16999999999999993, 'V': -0.5699999999999998, 'D': -0.34999999999999964, 'I': -1.5699999999999998, 'L': -1.5699999999999998, 'N': -0.52, 'M': -1.9999999999999996, 'Q': -1.52, 'K': -2.3399999999999994, 'E': -1.3499999999999996, 'H': -2.23, 'F': -3.4599999999999995, 'R': -3.6999999999999997, 'Y': -4.039999999999999, 'W': -5.65}, 'S': {'G': -1.6, 'A': -0.6000000000000001, 'C': -0.8300000000000001, 'S': -0.0, 'P': -1.12, 'T': -1.0, 'V': -1.4, 'D': -1.1799999999999997, 'I': -2.4, 'L': -2.4, 'N': -1.35, 'M': -2.8299999999999996, 'Q': -2.35, 'K': -3.1699999999999995, 'E': -2.1799999999999997, 'H': -3.06, 'F': -4.289999999999999, 'R': -4.529999999999999, 'Y': -4.869999999999999, 'W': -6.48}, 'P': {'G': -2.72, 'A': -1.7200000000000002, 'C': -0.29000000000000004, 'S': -1.12, 'P': -0.0, 'T': -0.1200000000000001, 'V': -0.2799999999999998, 'D': -0.05999999999999961, 'I': -1.2799999999999998, 'L': -1.2799999999999998, 'N': -0.22999999999999998, 'M': -1.7099999999999995, 'Q': -1.23, 'K': -2.0499999999999994, 'E': -1.0599999999999996, 'H': -1.94, 'F': -3.1699999999999995, 'R': -3.4099999999999997, 'Y': -3.7499999999999996, 'W': -5.359999999999999}, 'T': {'G': -2.6, 'A': -1.6, 'C': -0.16999999999999993, 'S': -1.0, 'P': -0.1200000000000001, 'T': -0.0, 'V': -0.3999999999999999, 'D': -0.17999999999999972, 'I': -1.4, 'L': -1.4, 'N': -0.3500000000000001, 'M': -1.8299999999999996, 'Q': -1.35, 'K': -2.1699999999999995, 'E': -1.1799999999999997, 'H': -2.06, 'F': -3.2899999999999996, 'R': -3.53, 'Y': -3.8699999999999997, 'W': -5.48}, 'V': {'G': -3.0, 'A': -2.0, 'C': -0.5699999999999998, 'S': -1.4, 'P': -0.2799999999999998, 'T': -0.3999999999999999, 'V': -0.0, 'D': -0.2200000000000002, 'I': -1.0, 'L': -1.0, 'N': -0.04999999999999982, 'M': -1.4299999999999997, 'Q': -0.9500000000000002, 'K': -1.7699999999999996, 'E': -0.7799999999999998, 'H': -1.6600000000000001, 'F': -2.8899999999999997, 'R': -3.13, 'Y': -3.4699999999999998, 'W': -5.08}, 'D': {'G': -2.78, 'A': -1.7799999999999998, 'C': -0.34999999999999964, 'S': -1.1799999999999997, 'P': -0.05999999999999961, 'T': -0.17999999999999972, 'V': -0.2200000000000002, 'D': -0.0, 'I': -1.2200000000000002, 'L': -1.2200000000000002, 'N': -0.17000000000000037, 'M': -1.65, 'Q': -1.1700000000000004, 'K': -1.9899999999999998, 'E': -1.0, 'H': -1.8800000000000003, 'F': -3.11, 'R': -3.35, 'Y': -3.69, 'W': -5.300000000000001}, 'I': {'G': -4.0, 'A': -3.0, 'C': -1.5699999999999998, 'S': -2.4, 'P': -1.2799999999999998, 'T': -1.4, 'V': -1.0, 'D': -1.2200000000000002, 'I': -0.0, 'L': -0.0, 'N': -1.0499999999999998, 'M': -0.4299999999999997, 'Q': -0.04999999999999982, 'K': -0.7699999999999996, 'E': -0.2200000000000002, 'H': -0.6600000000000001, 'F': -1.8899999999999997, 'R': -2.13, 'Y': -2.4699999999999998, 'W': -4.08}, 'L': {'G': -4.0, 'A': -3.0, 'C': -1.5699999999999998, 'S': -2.4, 'P': -1.2799999999999998, 'T': -1.4, 'V': -1.0, 'D': -1.2200000000000002, 'I': -0.0, 'L': -0.0, 'N': -1.0499999999999998, 'M': -0.4299999999999997, 'Q': -0.04999999999999982, 'K': -0.7699999999999996, 'E': -0.2200000000000002, 'H': -0.6600000000000001, 'F': -1.8899999999999997, 'R': -2.13, 'Y': -2.4699999999999998, 'W': -4.08}, 'N': {'G': -2.95, 'A': -1.9500000000000002, 'C': -0.52, 'S': -1.35, 'P': -0.22999999999999998, 'T': -0.3500000000000001, 'V': -0.04999999999999982, 'D': -0.17000000000000037, 'I': -1.0499999999999998, 'L': -1.0499999999999998, 'N': -0.0, 'M': -1.4799999999999995, 'Q': -1.0, 'K': -1.8199999999999994, 'E': -0.8299999999999996, 'H': -1.71, 'F': -2.9399999999999995, 'R': -3.1799999999999997, 'Y': -3.5199999999999996, 'W': -5.13}, 'M': {'G': -4.43, 'A': -3.4299999999999997, 'C': -1.9999999999999996, 'S': -2.8299999999999996, 'P': -1.7099999999999995, 'T': -1.8299999999999996, 'V': -1.4299999999999997, 'D': -1.65, 'I': -0.4299999999999997, 'L': -0.4299999999999997, 'N': -1.4799999999999995, 'M': -0.0, 'Q': -0.47999999999999954, 'K': -0.33999999999999986, 'E': -0.6499999999999999, 'H': -0.23000000000000043, 'F': -1.46, 'R': -1.7000000000000002, 'Y': -2.04, 'W': -3.6500000000000004}, 'Q': {'G': -3.95, 'A': -2.95, 'C': -1.52, 'S': -2.35, 'P': -1.23, 'T': -1.35, 'V': -0.9500000000000002, 'D': -1.1700000000000004, 'I': -0.04999999999999982, 'L': -0.04999999999999982, 'N': -1.0, 'M': -0.47999999999999954, 'Q': -0.0, 'K': -0.8199999999999994, 'E': -0.17000000000000037, 'H': -0.71, 'F': -1.9399999999999995, 'R': -2.1799999999999997, 'Y': -2.5199999999999996, 'W': -4.13}, 'K': {'G': -4.77, 'A': -3.7699999999999996, 'C': -2.3399999999999994, 'S': -3.1699999999999995, 'P': -2.0499999999999994, 'T': -2.1699999999999995, 'V': -1.7699999999999996, 'D': -1.9899999999999998, 'I': -0.7699999999999996, 'L': -0.7699999999999996, 'N': -1.8199999999999994, 'M': -0.33999999999999986, 'Q': -0.8199999999999994, 'K': -0.0, 'E': -0.9899999999999998, 'H': -0.10999999999999943, 'F': -1.12, 'R': -1.3600000000000003, 'Y': -1.7000000000000002, 'W': -3.3100000000000005}, 'E': {'G': -3.78, 'A': -2.78, 'C': -1.3499999999999996, 'S': -2.1799999999999997, 'P': -1.0599999999999996, 'T': -1.1799999999999997, 'V': -0.7799999999999998, 'D': -1.0, 'I': -0.2200000000000002, 'L': -0.2200000000000002, 'N': -0.8299999999999996, 'M': -0.6499999999999999, 'Q': -0.17000000000000037, 'K': -0.9899999999999998, 'E': -0.0, 'H': -0.8800000000000003, 'F': -2.11, 'R': -2.35, 'Y': -2.69, 'W': -4.300000000000001}, 'H': {'G': -4.66, 'A': -3.66, 'C': -2.23, 'S': -3.06, 'P': -1.94, 'T': -2.06, 'V': -1.6600000000000001, 'D': -1.8800000000000003, 'I': -0.6600000000000001, 'L': -0.6600000000000001, 'N': -1.71, 'M': -0.23000000000000043, 'Q': -0.71, 'K': -0.10999999999999943, 'E': -0.8800000000000003, 'H': -0.0, 'F': -1.2299999999999995, 'R': -1.4699999999999998, 'Y': -1.8099999999999996, 'W': -3.42}, 'F': {'G': -5.89, 'A': -4.89, 'C': -3.4599999999999995, 'S': -4.289999999999999, 'P': -3.1699999999999995, 'T': -3.2899999999999996, 'V': -2.8899999999999997, 'D': -3.11, 'I': -1.8899999999999997, 'L': -1.8899999999999997, 'N': -2.9399999999999995, 'M': -1.46, 'Q': -1.9399999999999995, 'K': -1.12, 'E': -2.11, 'H': -1.2299999999999995, 'F': -0.0, 'R': -0.2400000000000002, 'Y': -0.5800000000000001, 'W': -2.1900000000000004}, 'R': {'G': -6.13, 'A': -5.13, 'C': -3.6999999999999997, 'S': -4.529999999999999, 'P': -3.4099999999999997, 'T': -3.53, 'V': -3.13, 'D': -3.35, 'I': -2.13, 'L': -2.13, 'N': -3.1799999999999997, 'M': -1.7000000000000002, 'Q': -2.1799999999999997, 'K': -1.3600000000000003, 'E': -2.35, 'H': -1.4699999999999998, 'F': -0.2400000000000002, 'R': -0.0, 'Y': -0.33999999999999986, 'W': -1.9500000000000002}, 'Y': {'G': -6.47, 'A': -5.47, 'C': -4.039999999999999, 'S': -4.869999999999999, 'P': -3.7499999999999996, 'T': -3.8699999999999997, 'V': -3.4699999999999998, 'D': -3.69, 'I': -2.4699999999999998, 'L': -2.4699999999999998, 'N': -3.5199999999999996, 'M': -2.04, 'Q': -2.5199999999999996, 'K': -1.7000000000000002, 'E': -2.69, 'H': -1.8099999999999996, 'F': -0.5800000000000001, 'R': -0.33999999999999986, 'Y': -0.0, 'W': -1.6100000000000003}, 'W': {'G': -8.08, 'A': -7.08, 'C': -5.65, 'S': -6.48, 'P': -5.359999999999999, 'T': -5.48, 'V': -5.08, 'D': -5.300000000000001, 'I': -4.08, 'L': -4.08, 'N': -5.13, 'M': -3.6500000000000004, 'Q': -4.13, 'K': -3.3100000000000005, 'E': -4.300000000000001, 'H': -3.42, 'F': -2.1900000000000004, 'R': -1.9500000000000002, 'Y': -1.6100000000000003, 'W': -0.0}}

# NEG_ABS_DIFF_VDW_RADIUS = {}
# for wt in NEG_ABS_DIFF_VDW_RADIUS_UNNORMALIZED:
#     aas, raw_values = [], []
#     for mt in NEG_ABS_DIFF_VDW_RADIUS_UNNORMALIZED[wt]:
#         aas.append(mt)
#         raw_values.append(-NEG_ABS_DIFF_VDW_RADIUS_UNNORMALIZED[wt][mt])
#     normalization = np.sum(raw_values)
#     NEG_ABS_DIFF_VDW_RADIUS[wt] = {aa: -value / normalization for aa, value in zip(aas, raw_values)}

BLOSUM62 = {
    'C': {'C': 9, 'S': -1, 'T': -1, 'A': 0, 'G': -3, 'P': -3, 'D': -3, 'E': -4, 'Q': -3, 'N': -3, 'H': -3, 'R': -3, 'K': -3, 'M': -1, 'I': -1, 'L': -1, 'V': -1, 'W': -2, 'Y': -2, 'F': -2},
    'S': {'C': -1, 'S': 4, 'T': 1, 'A': 1, 'G': 0, 'P': -1, 'D': 0, 'E': 0, 'Q': 0, 'N': 1, 'H': -1, 'R': -1, 'K': 0, 'M': -1, 'I': -2, 'L': -2, 'V': -2, 'W': -3, 'Y': -2, 'F': -2},
    'T': {'C': -1, 'S': 1, 'T': 5, 'A': 0, 'G': -2, 'P': -1, 'D': -1, 'E': -1, 'Q': -1, 'N': 0, 'H': -2, 'R': -1, 'K': -1, 'M': -1, 'I': -1, 'L': -1, 'V': 0, 'W': -2, 'Y': -2, 'F': -2},
    'A': {'C': 0, 'S': 1, 'T': 0, 'A': 4, 'G': 0, 'P': -1, 'D': -2, 'E': -1, 'Q': -1, 'N': -2, 'H': -2, 'R': -1, 'K': -1, 'M': -1, 'I': -1, 'L': -1, 'V': 0, 'W': -3, 'Y': -2, 'F': -2},
    'G': {'C': -3, 'S': 0, 'T': -2, 'A': 0, 'G': 6, 'P': -2, 'D': -1, 'E': -2, 'Q': -2, 'N': 0, 'H': -2, 'R': -2, 'K': -2, 'M': -3, 'I': -4, 'L': -4, 'V': -3, 'W': -2, 'Y': -3, 'F': -3},
    'P': {'C': -3, 'S': -1, 'T': -1, 'A': -1, 'G': -2, 'P': 7, 'D': -1, 'E': -1, 'Q': -1, 'N': -1, 'H': -2, 'R': -2, 'K': -1, 'M': -2, 'I': -3, 'L': -3, 'V': -2, 'W': -4, 'Y': -3, 'F': -4},
    'D': {'C': -3, 'S': 0, 'T': -1, 'A': -2, 'G': -1, 'P': -1, 'D': 6, 'E': 2, 'Q': 0, 'N': 1, 'H': -1, 'R': -2, 'K': -1, 'M': -3, 'I': -3, 'L': -4, 'V': -3, 'W': -4, 'Y': -3, 'F': -3},
    'E': {'C': -4, 'S': 0, 'T': -1, 'A': -1, 'G': -2, 'P': -1, 'D': 2, 'E': 5, 'Q': 2, 'N': 0, 'H': 0, 'R': 0, 'K': 1, 'M': -2, 'I': -3, 'L': -3, 'V': -2, 'W': -3, 'Y': -2, 'F': -3},
    'Q': {'C': -3, 'S': 0, 'T': -1, 'A': -1, 'G': -2, 'P': -1, 'D': 0, 'E': 2, 'Q': 5, 'N': 0, 'H': 0, 'R': 1, 'K': 1, 'M': 0, 'I': -3, 'L': -2, 'V': -2, 'W': -2, 'Y': -1, 'F': -3},
    'N': {'C': -3, 'S': 1, 'T': 0, 'A': -2, 'G': 0, 'P': -2, 'D': 1, 'E': 0, 'Q': 0, 'N': 6, 'H': 1, 'R': 0, 'K': 0, 'M': -2, 'I': -3, 'L': -3, 'V': -3, 'W': -4, 'Y': -2, 'F': -3},
    'H': {'C': -3, 'S': -1, 'T': -2, 'A': -2, 'G': -2, 'P': -2, 'D': -1, 'E': 0, 'Q': 0, 'N': 1, 'H': 8, 'R': 0, 'K': -1, 'M': -2, 'I': -3, 'L': -3, 'V': -3, 'W': -2, 'Y': 2, 'F': -1},
    'R': {'C': -3, 'S': -1, 'T': -1, 'A': -1, 'G': -2, 'P': -2, 'D': -2, 'E': 0, 'Q': 1, 'N': 0, 'H': 0, 'R': 5, 'K': 2, 'M': -1, 'I': -3, 'L': -2, 'V': -3, 'W': -3, 'Y': -2, 'F': -3},
    'K': {'C': -3, 'S': 0, 'T': -1, 'A': -1, 'G': -2, 'P': -1, 'D': -1, 'E': 1, 'Q': 1, 'N': 0, 'H': -1, 'R': 2, 'K': 5, 'M': -1, 'I': -3, 'L': -2, 'V': -2, 'W': -3, 'Y': -2, 'F': -3},
    'M': {'C': -1, 'S': -1, 'T': -1, 'A': -1, 'G': -3, 'P': -2, 'D': -3, 'E': -2, 'Q': 0, 'N': -2, 'H': -2, 'R': -1, 'K': -1, 'M': 5, 'I': 1, 'L': 2, 'V': 1, 'W': -1, 'Y': -1, 'F': 0},
    'I': {'C': -1, 'S': -2, 'T': -1, 'A': -1, 'G': -4, 'P': -3, 'D': -3, 'E': -3, 'Q': -3, 'N': -3, 'H': -3, 'R': -3, 'K': -3, 'M': 1, 'I': 4, 'L': 2, 'V': 3, 'W': -3, 'Y': -1, 'F': 0},
    'L': {'C': -1, 'S': -2, 'T': -1, 'A': -1, 'G': -4, 'P': -3, 'D': -4, 'E': -3, 'Q': -2, 'N': -3, 'H': -3, 'R': -2, 'K': -2, 'M': 2, 'I': 2, 'L': 4, 'V': 1, 'W': -2, 'Y': -1, 'F': 0},
    'V': {'C': -1, 'S': -2, 'T': 0, 'A': 0, 'G': -3, 'P': -2, 'D': -3, 'E': -2, 'Q': -2, 'N': -3, 'H': -3, 'R': -3, 'K': -2, 'M': 1, 'I': 3, 'L': 1, 'V': 4, 'W': -3, 'Y': -1, 'F': -1},
    'W': {'C': -2, 'S': -3, 'T': -2, 'A': -3, 'G': -2, 'P': -4, 'D': -4, 'E': -3, 'Q': -2, 'N': -4, 'H': -2, 'R': -3, 'K': -3, 'M': -1, 'I': -3, 'L': -2, 'V': -3, 'W': 11, 'Y': 2, 'F': 1},
    'Y': {'C': -2, 'S': -2, 'T': -2, 'A': -2, 'G': -3, 'P': -3, 'D': -3, 'E': -2, 'Q': -1, 'N': -2, 'H': 2, 'R': -2, 'K': -2, 'M': -1, 'I': -1, 'L': -1, 'V': -1, 'W': 2, 'Y': 7, 'F': 3},
    'F': {'C': -2, 'S': -2, 'T': -2, 'A': -2, 'G': -3, 'P': -4, 'D': -3, 'E': -3, 'Q': -3, 'N': -3, 'H': -1, 'R': -3, 'K': -3, 'M': 0, 'I': 0, 'L': 0, 'V': -1, 'W': 1, 'Y': 3, 'F': 6}
}

# this matrix is from Luksza et al. 2022, https://github.com/LukszaLab/NeoantigenEditing/blob/main/data/epitope_distance_model_parameters.json

LUKSZA_M = {"A->A": 0.0, "A->C": 3.7673066605568826, "A->D": 6.858666899068506, "A->E": 6.645123081893246, "A->F": 8.316884322665505, "A->G": 4.054486363743763, "A->H": 7.80927252686884, "A->I": 5.287574981132023, "A->K": 6.718712490316743, "A->L": 5.629723949153348, "A->M": 4.709451886491528, "A->N": 5.702888846341898, "A->P": 5.307824326502934, "A->Q": 5.96092500006195, "A->R": 7.355645531294955, "A->S": 2.7768641441391444, "A->T": 1.6914472360189268, "A->V": 4.573483349970818, "A->W": 9.808973736427841, "A->Y": 8.209220399536266, "C->A": 3.7673066605568826, "C->C": 0.0, "C->D": 10.612906903098432, "C->E": 10.19062536720303, "C->F": 8.630471802181635, "C->G": 7.19790603239027, "C->H": 10.433394720342184, "C->I": 3.609796735529243, "C->K": 10.05141434612365, "C->L": 4.445004171745916, "C->M": 4.804920734998789, "C->N": 9.384847912477928, "C->P": 8.871919951434778, "C->Q": 9.22876755094634, "C->R": 10.540008923700857, "C->S": 6.459557371202782, "C->T": 4.766362069061748, "C->V": 3.124048817228584, "C->W": 10.380098238149005, "C->Y": 9.151656483431939, "D->A": 6.858666899068506, "D->C": 10.612906903098432, "D->D": 0.0, "D->E": 2.2073726972863037, "D->F": 10.981800176179599, "D->G": 5.410986374502014, "D->H": 6.160365957017682, "D->I": 11.07284940900755, "D->K": 3.3568210278104593, "D->L": 10.943125305182395, "D->M": 9.331429674784955, "D->N": 1.5731887789560899, "D->P": 3.541769886738501, "D->Q": 3.6321995942385272, "D->R": 4.125556147119299, "D->S": 4.194813374630591, "D->T": 6.123211387738817, "D->V": 10.462457242314292, "D->W": 11.582790030932431, "D->Y": 9.94271706482523, "E->A": 6.645123081893246, "E->C": 10.19062536720303, "E->D": 2.2073726972863037, "E->E": 0.0, "E->F": 9.049248081592172, "E->G": 6.546658177551038, "E->H": 3.9544410215949877, "E->I": 9.93862275896961, "E->K": 1.1525392080966916, "E->L": 9.650451830548775, "E->M": 7.9627558953165725, "E->N": 1.344803035889008, "E->P": 5.133917401663634, "E->Q": 1.6024308032067456, "E->R": 1.9341446277992693, "E->S": 3.8943536035377697, "E->T": 5.434504869409326, "E->V": 9.408630590313022, "E->W": 9.500721197130058, "E->Y": 7.909628018608502, "F->A": 8.316884322665505, "F->C": 8.630471802181635, "F->D": 10.981800176179599, "F->E": 9.049248081592172, "F->F": 0.0, "F->G": 11.846828489539009, "F->H": 5.937026904981663, "F->I": 5.3482526666590955, "F->K": 8.038690415955843, "F->L": 4.434763767762229, "F->M": 3.910000926335655, "F->N": 9.44307888557397, "F->P": 12.04888386013437, "F->Q": 7.4504124864668855, "F->R": 7.726353684727768, "F->S": 8.273389470312676, "F->T": 6.989589334998694, "F->V": 5.581006381543492, "F->W": 1.7732200005198253, "F->Y": 1.4664550890160293, "G->A": 4.054486363743763, "G->C": 7.19790603239027, "G->D": 5.410986374502014, "G->E": 6.546658177551038, "G->F": 11.846828489539009, "G->G": 0.0, "G->H": 9.471983845230948, "G->I": 9.338753823510922, "G->K": 7.26183507210032, "G->L": 9.671860878370772, "G->M": 8.605231281152383, "G->N": 5.2094521066253945, "G->P": 2.1336864685786554, "G->Q": 6.849844582124883, "G->R": 8.11982440582287, "G->S": 3.8149127037464723, "G->T": 4.891647465499837, "G->V": 8.624023017473489, "G->W": 13.112125954558945, "G->Y": 11.408654021725596, "H->A": 7.80927252686884, "H->C": 10.433394720342184, "H->D": 6.160365957017682, "H->E": 3.9544410215949877, "H->F": 5.937026904981663, "H->G": 9.471983845230948, "H->H": 0.0, "H->I": 8.790891788166004, "H->K": 2.803559283159802, "H->L": 8.178080668130237, "H->M": 6.557207973559407, "H->N": 4.963283345859569, "H->P": 8.625330025655463, "H->Q": 2.7526237472532045, "H->R": 2.110556470225403, "H->S": 5.8134337062799055, "H->T": 6.141639435657454, "H->V": 8.503081322149713, "H->W": 5.900535571611977, "H->Y": 4.553137354727778, "I->A": 5.287574981132023, "I->C": 3.609796735529243, "I->D": 11.07284940900755, "I->E": 9.93862275896961, "I->F": 5.3482526666590955, "I->G": 9.338753823510922, "I->H": 8.790891788166004, "I->I": 0.0, "I->K": 9.401132861352892, "I->L": 0.9168820667305412, "I->M": 2.234460175971931, "I->N": 9.578851100030663, "I->P": 10.4594587842663, "I->Q": 8.569324927015641, "I->R": 9.60380258068956, "I->S": 7.042146794266393, "I->T": 5.069101322156581, "I->V": 0.7149005891484997, "I->W": 7.120277378143191, "I->Y": 6.194005385847643, "K->A": 6.718712490316743, "K->C": 10.05141434612365, "K->D": 3.3568210278104593, "K->E": 1.1525392080966916, "K->F": 8.038690415955843, "K->G": 7.26183507210032, "K->H": 2.803559283159802, "K->I": 9.401132861352892, "K->K": 0.0, "K->L": 9.02353822212172, "K->M": 7.318426697404776, "K->N": 2.264193709562544, "K->P": 6.066093946206223, "K->Q": 0.843068559055228, "K->R": 0.8764534846716978, "K->S": 4.118533574677532, "K->T": 5.304308039139411, "K->V": 8.926949401129649, "K->W": 8.400879820164631, "K->Y": 6.843465356607772, "L->A": 5.629723949153348, "L->C": 4.445004171745916, "L->D": 10.943125305182395, "L->E": 9.650451830548775, "L->F": 4.434763767762229, "L->G": 9.671860878370772, "L->H": 8.178080668130237, "L->I": 0.9168820667305412, "L->K": 9.02353822212172, "L->L": 0.0, "L->M": 1.706026531134751, "L->N": 9.4114041266561, "L->P": 10.628485573776425, "L->Q": 8.208621824427695, "L->R": 9.15051125338444, "L->S": 7.0547080789185435, "L->T": 5.131243872079878, "L->V": 1.3409264240426382, "L->W": 6.205812582692975, "L->Y": 5.3209200781931925, "M->A": 4.709451886491528, "M->C": 4.804920734998789, "M->D": 9.331429674784955, "M->E": 7.9627558953165725, "M->F": 3.910000926335655, "M->G": 8.605231281152383, "M->H": 6.557207973559407, "M->I": 2.234460175971931, "M->K": 7.318426697404776, "M->L": 1.706026531134751, "M->M": 0.0, "M->N": 7.781694348961095, "M->P": 9.31144553586053, "M->Q": 6.505803737707016, "M->R": 7.449045677262714, "M->S": 5.604048881547064, "M->T": 3.8022989701449266, "M->V": 2.0431917263232804, "M->W": 5.615483656942405, "M->Y": 4.350926772824042, "N->A": 5.702888846341898, "N->C": 9.384847912477928, "N->D": 1.5731887789560899, "N->E": 1.344803035889008, "N->F": 9.44307888557397, "N->G": 5.2094521066253945, "N->H": 4.963283345859569, "N->I": 9.578851100030663, "N->K": 2.264193709562544, "N->L": 9.4114041266561, "N->M": 7.781694348961095, "N->N": 0.0, "N->P": 3.8190489015448565, "N->Q": 2.2558324791172084, "N->R": 3.133822704432521, "N->S": 2.9331098323975704, "N->T": 4.737598873449183, "N->V": 8.988713876632943, "N->W": 10.114658060508463, "N->Y": 8.448967078194036, "P->A": 5.307824326502934, "P->C": 8.871919951434778, "P->D": 3.541769886738501, "P->E": 5.133917401663634, "P->F": 12.04888386013437, "P->G": 2.1336864685786554, "P->H": 8.625330025655463, "P->I": 10.4594587842663, "P->K": 6.066093946206223, "P->L": 10.628485573776425, "P->M": 9.31144553586053, "P->N": 3.8190489015448565, "P->P": 0.0, "P->Q": 5.876658706110999, "P->R": 6.941611570958817, "P->S": 3.799825059499118, "P->T": 5.521921344947621, "P->V": 9.760599201522258, "P->W": 13.084866061501023, "P->Y": 11.363260737036889, "Q->A": 5.96092500006195, "Q->C": 9.22876755094634, "Q->D": 3.6321995942385272, "Q->E": 1.6024308032067456, "Q->F": 7.4504124864668855, "Q->G": 6.849844582124883, "Q->H": 2.7526237472532045, "Q->I": 8.569324927015641, "Q->K": 0.843068559055228, "Q->L": 8.208621824427695, "Q->M": 6.505803737707016, "Q->N": 2.2558324791172084, "Q->P": 5.876658706110999, "Q->Q": 0.0, "Q->R": 1.4063655296564266, "Q->S": 3.4618946935227064, "Q->T": 4.497357176081819, "Q->V": 8.088323257269053, "Q->W": 7.956101872064475, "Q->Y": 6.3360736873501935, "R->A": 7.355645531294955, "R->C": 10.540008923700857, "R->D": 4.125556147119299, "R->E": 1.9341446277992693, "R->F": 7.726353684727768, "R->G": 8.11982440582287, "R->H": 2.110556470225403, "R->I": 9.60380258068956, "R->K": 0.8764534846716978, "R->L": 9.15051125338444, "R->M": 7.449045677262714, "R->N": 3.133822704432521, "R->P": 6.941611570958817, "R->Q": 1.4063655296564266, "R->R": 0.0, "R->S": 4.860552637259271, "R->T": 5.853391669257117, "R->V": 9.180357465640842, "R->W": 7.918173418697156, "R->Y": 6.444541795134483, "S->A": 2.7768641441391444, "S->C": 6.459557371202782, "S->D": 4.194813374630591, "S->E": 3.8943536035377697, "S->F": 8.273389470312676, "S->G": 3.8149127037464723, "S->H": 5.8134337062799055, "S->I": 7.042146794266393, "S->K": 4.118533574677532, "S->L": 7.0547080789185435, "S->M": 5.604048881547064, "S->N": 2.9331098323975704, "S->P": 3.799825059499118, "S->Q": 3.4618946935227064, "S->R": 4.860552637259271, "S->S": 0.0, "S->T": 1.9807227383836576, "S->V": 6.3893843494236595, "S->W": 9.400205949574959, "S->Y": 7.681563828806445, "T->A": 1.6914472360189268, "T->C": 4.766362069061748, "T->D": 6.123211387738817, "T->E": 5.434504869409326, "T->F": 6.989589334998694, "T->G": 4.891647465499837, "T->H": 6.141639435657454, "T->I": 5.069101322156581, "T->K": 5.304308039139411, "T->L": 5.131243872079878, "T->M": 3.8022989701449266, "T->N": 4.737598873449183, "T->P": 5.521921344947621, "T->Q": 4.497357176081819, "T->R": 5.853391669257117, "T->S": 1.9807227383836576, "T->T": 0.0, "T->V": 4.410060771483332, "T->W": 8.360787981361641, "T->Y": 6.705061937224871, "V->A": 4.573483349970818, "V->C": 3.124048817228584, "V->D": 10.462457242314292, "V->E": 9.408630590313022, "V->F": 5.581006381543492, "V->G": 8.624023017473489, "V->H": 8.503081322149713, "V->I": 0.7149005891484997, "V->K": 8.926949401129649, "V->L": 1.3409264240426382, "V->M": 2.0431917263232804, "V->N": 8.988713876632943, "V->P": 9.760599201522258, "V->Q": 8.088323257269053, "V->R": 9.180357465640842, "V->S": 6.3893843494236595, "V->T": 4.410060771483332, "V->V": 0.0, "V->W": 7.349765799987526, "V->Y": 6.2779448590733224, "W->A": 9.808973736427841, "W->C": 10.380098238149005, "W->D": 11.582790030932431, "W->E": 9.500721197130058, "W->F": 1.7732200005198253, "W->G": 13.112125954558945, "W->H": 5.900535571611977, "W->I": 7.120277378143191, "W->K": 8.400879820164631, "W->L": 6.205812582692975, "W->M": 5.615483656942405, "W->N": 10.114658060508463, "W->P": 13.084866061501023, "W->Q": 7.956101872064475, "W->R": 7.918173418697156, "W->S": 9.400205949574959, "W->T": 8.360787981361641, "W->V": 7.349765799987526, "W->W": 0.0, "W->Y": 1.7222401310301723, "Y->A": 8.209220399536266, "Y->C": 9.151656483431939, "Y->D": 9.94271706482523, "Y->E": 7.909628018608502, "Y->F": 1.4664550890160293, "Y->G": 11.408654021725596, "Y->H": 4.553137354727778, "Y->I": 6.194005385847643, "Y->K": 6.843465356607772, "Y->L": 5.3209200781931925, "Y->M": 4.350926772824042, "Y->N": 8.448967078194036, "Y->P": 11.363260737036889, "Y->Q": 6.3360736873501935, "Y->R": 6.444541795134483, "Y->S": 7.681563828806445, "Y->T": 6.705061937224871, "Y->V": 6.2779448590733224, "Y->W": 1.7222401310301723, "Y->Y": 0.0}
LUKSZA_D = [0.4265316417189761, 0.7769577054740209, 1.1858350996115459, 1.2011211326454208, 1.6962418186727721, 1.4795549981576157, 1.38899685274111, 0.7822985074612253, 0.9749012286522828]

LUKSZA_CROSS_REACTIVITY_WITHOUT_D = {}
for key in LUKSZA_M.keys():
    wt, mt = key.split("->")
    if wt not in LUKSZA_CROSS_REACTIVITY_WITHOUT_D:
        LUKSZA_CROSS_REACTIVITY_WITHOUT_D[wt] = {}
    LUKSZA_CROSS_REACTIVITY_WITHOUT_D[wt][mt] = -LUKSZA_M[key] # make it negative so that higher == more likely to be observed

LUKSZA_CROSS_REACTIVITY = {'matrix': LUKSZA_CROSS_REACTIVITY_WITHOUT_D, 'd': LUKSZA_D}

NAME_TO_SUB_MATRIX = {
    'blosum62': BLOSUM62,
    'neg_abs_diff_vdw_radius': NEG_ABS_DIFF_VDW_RADIUS,
    'luksza_cross_reactivity': LUKSZA_CROSS_REACTIVITY,
    'luksza_cross_reactivity_without_d': LUKSZA_CROSS_REACTIVITY_WITHOUT_D,
}

